#!/usr/bin/env bash
################################################################################
# Copyright (C) 2015-* Phillip R. Jaenke <talecaster@rootwrym.com>
#
# Licensed under CC-BY-NC-4.0
# See /LICENSE for details
################################################################################
# talecaster/bin/boot
## Boot script for TaleCaster, called from init.d

. /opt/talecaster/lib/deploy.lib.sh

function message()
{
	printf '********************************************************************************\n'
	printf 'System IPv4 Address: %s\n' "${DEFAULT_IP4}"
	printf '\n'
	printf 'Application: %s\n' "${APPLICATION_NAME}" 
	printf '********************************************************************************\n'
}

function application_boot()
{
	if [ -f /opt/talecaster/id.service ]; then
		appid=$(cat /opt/talecaster/id.service)
	else
		return 0
	fi
	if [ -f /opt/talecaster/bin/$appid ]; then
		/opt/talecaster/bin/$appid
	fi
}

ingest_environment
application_boot
message > /message
